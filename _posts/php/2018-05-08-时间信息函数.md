---
layout: post
title: "时间信息函数"
date: 2018-05-08
tag: php
---

`unix时间戳`

电脑本身不认识时间，我们在电脑里面设置一个时间方便运算。于是我们规定了一种计算方式，unix时间戳。
从Unix纪元（1970 年 1月1日零时）开始到一个时间经过的秒数

-------------

`设置时区`

如果，我们是跨国的多语方程序，我们通常是通过在配置文件里面来写好了个时区，每次程序运行的时候。都会读取这个时区的设置，来显示时间

设置时区的函数为：

```
1). date_default_timezone_get()
2). date_default_timezone_set()

string date_default_timezone_get ( void )
功能：取得一个脚本中所有日期时间函数所使用的默认时区

<?php
    echo date_default_timezone_get ();
?>
这样就显示出来了当前设定的时间
```

```
bool date_default_timezone_set ( string $timezone_identifier )

功能：用于所有日期时间函数的默认时区

<?php
    //定义一下时区常量，以后你可以放到配置文件里
    define('TIME_ZONE','Asia/shanghai');
    //执行函数
    date_default_timezone_set(TIME_ZONE);
    echo date('Y-m-d H:i:s');
?>

注：时区列表请详见官方手册 http://php.net/manual/zh/timezones.php
```

-----------------

`time()` 函数的功能是获取当前时间的 Unix 时间戳

print_r(time());

`date()` 函数用于将一个时间进行格式化输出，以方便时间的显示或存储

```string date ( string $format [, int $timestamp] )```

在参数列表中:

$timestamp是一个时间戳，函数将这个时间戳按$format规定的格式输出

如果$timestamp没有输入值，则默认为当前的时间

$format是一个时间输出格式的字符串，需要使用规定的字符构造输出格式

显示出来当前的时间 echo date('Y-m-d H:i:s');  date('Y年m月d日')

-----------------

`getdate` 用来获取当前系统的时间，或者获得一个时间戳的具体含义

时间戳是一个长整数，表示getdate的语法格式如下所示

```array getdate ([ int $timestamp = time() ] )```

函数的返回值是一个根据timestamp得到的 ` 包含有时间信息的数组` array(11)

如果没有参数，则会返回当前的时间

getdate返回的数组，键名包括时间和日期的完整信息

```
<?php
    $mytime = getdate();

    echo "年 :".$mytime['year']."\n";
    echo "月 :".$mytime['mon']."\n";
    echo "日 :".$mytime['mday']."\n";
    echo "时 :".$mytime['hours']."\n";
    echo "分 :".$mytime['minutes']."\n";
    echo "秒 :".$mytime['seconds']."\n";
    echo "一个小时中的第几分 :".$mytime['minutes']."\n";
    echo "这是一分钟的第几秒 :".$mytime['seconds']."\n";
    echo "星期名称 :".$mytime['weekday']."\n";
    echo "月份名称 :".$mytime['month']."\n";
    echo "时间戳   :".$mytime[0]."\n";
```

----------------

`日期验证函数`

checkdate可以判断一个输出的日期是否有效

在实际的工作中，我们需要经常用于检测常用于用户提交表单的数据验证

例如：验证用户输入的时间是否正确

```bool checkdate ( int $month , int $day , int $year )```

```
试试2011年有没有2月29日
如果是有效的时间就返回真，如果不是有效的时间就返回假
<?php
var_dump(checkdate(12, 31, 2018));
var_dump(checkdate(2, 29, 2011));

输出结果：
bool(true)
bool(false)
```

---------------

`获取本地化时间戳函数`

在实际的工作中我们还需要经常用到指定某个时间生成

例如：需要找到昨天到今天此时此刻的注册用户

那么我们需要做两件事情：

    1.得到当前的时间unix时间戳  用time()函数就可以直接搞定

    2.那么昨天指定时间该怎么生成呢  这个时候我们就需要使用到mktime()函数。简称：make time.创建时间

生成出来的时间最好是unix时间戳。因为是1970年1月1日0时到现在的时间。我们做一个区间判断，就把昨天到今天注册的用户按照时间筛选出来了。

我们的mktime()函数可以对一个日期和时间获得一个本地化时间戳。其语法格式如下所示：

```
int mktime (int $hour [, int $minute [, int $second [, int $month [, int $day [. int$year [, int $.is_dstl.l } ] ] 31 )
```
函数的参数分别表示：时、分、秒、月、日、年、是否为夏令时。在使用这个函数时，需要注意所列的参数要与函数的参数含义相同。例如，下面的代码实现了用mktime构造一个时间戳的功能

<?php
echo  mktime (13 ,15 , 30, 8,18, 2008) ;
?>
运行程序结果如下所示：

1219036530

mktime函数的返回结果是一个Unix时间戳，对用户的含义不大，常常与date函数一起完成时间的转换。

例如，下面的代码实现对时间的运算：

```
<?php
echo date("m-d-Y h:m:s")."\n";
echo date("m-d-Y h:m:s",mktime(10,15,35,date("m"),date("d"),date("Y")))."\n";
echo date("m-d-Y h:m:s",mktime(10,15,35,date("m"),date("d")-30,date("Y")))."\n";
```

int strtotime ( string $time [, int $now = time() ] )

它能将将英文文本的日期时间描述解析为 Unix 时间戳

参数：

    1.传入一个字符串的时间

    2.可选参数为是否传入unix时间戳，如果不传则是当前的unix时间戳

实验一下，看看手册中提供的一些例子：

```
<?php

    echo time();
    //now为现在的当前时间
    echo strtotime("now")."<br />";
    //2000年9月10日
    echo strtotime("10 September 2000")."<br />";

    //当前时间加一天
    echo strtotime("+1 day")."<br />";
    //当前时间加一周
    echo strtotime("+1 week")."<br />";
    //当前时间加一周2天4小时2秒
    echo strtotime("+1 week 2 days 4 hours 2 seconds")."<br />";

    //下一个星期四
    echo strtotime("next Thursday")."<br />";
    //上一个星期一
    echo strtotime("last Monday")."<br />";
```

通过上例发现，把一些时间通通加上了或者减去了英文中所表示的指定时间段

echo strtotime('+2 weeks 2 days 2 hours 2 seconds')

-------------------------

程序的运行速度太快了。快到只有0.00000几秒的一刹那

mixed microtime ([ bool $get_as_float ] )

microtime()这个函数，能够返回当前 Unix 时间戳和微秒数

参数：
如果你传入true的话，将会返回一个浮点类型的时间，这样方便参与运算

```
<?php
        //开始时间
        $time_start = microtime(true);
        //循环一万次
        for($i = 0 ; $i < 10000 ; $i++){

           //你可以用上，mktime() 生成一个昨天的时间
           //再用strtotime() 生成一个昨天的时间
           //对比两个函数认的效率高
            //echo mktime(12,1,2,5,9,2019).'<br>';
            echo strtotime('-1 day').'<br>';
        }

        //结整时间
        $time_end = microtime(true);
        //相减得到运行时间
        $time = $time_end - $time_start;

        echo "这个脚本执行的时间为 $time seconds\n";
```

最后输出的结果就是我们实际的函数的执行时间。你可以多对比几次，看看最终的结果,
谁的时间短，在实际的工作中，你就可以经常使用哪个函数
