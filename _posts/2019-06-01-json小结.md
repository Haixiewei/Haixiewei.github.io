---
layout: post
title: "json小结"
date: 2019-06-01
tag: json
---

### 一、对象序列化成JSON格式的字符串

```
var xiaoming = {
    name: '小明',
    age: 14,
    skills: ['JavaScript', 'Java']
};
var s = JSON.stringify(xiaoming);
console.log(s);
console.log(JSON.stringify(xiaoming, null, ' '))
console.log(JSON.stringify(xiaoming, ['name', 'age'], ' '))
```

```
{"name":"小明","age":14,"skills":["JavaScript","Java"]}
{
 "name": "小明",
 "age": 14,
 "skills": [
  "JavaScript",
  "Java"
 ]
}
{
 "name": "小明",
 "age": 14
}
```

还可以传入一个函数，这样对象的每个键值对都会被函数先处理

```
function convert(key, value) {
    if (typeof value === 'string') {
        return value.toUpperCase();
    }
    return value;
}

JSON.stringify(xiaoming, convert, ' ');

{
     "name": "小明",
     "age": 14,
     "skills": [
      "JAVASCRIPT",
      "JAVA"
     ]
}
```

把任何JavaScript对象变成JSON，就是把这个对象序列化成一个JSON格式的字符串，这样才能够通过网络传递给其他计算机<br>

如果我们收到一个JSON格式的字符串，只需要把它反序列化成一个JavaScript对象，就可以在JavaScript中直接使用这个对象了<br>

`如果我们还想要精确控制如何序列化，可定义一个toJSON()方法，直接返回JSON应该序列化数据`

```
var xiaoming = {
	name: '小明',
	age: 14,
	skills: ['JavaScript', 'Java'],
	toJSON: function () {
		return { // 只输出name和age，并且改变了key
			'NAME': this.name,
			'AGE': this.age
		};
	}
};
console.log(JSON.stringify(xiaoming))

//'{"NAME":"小明","AGE":14}'
```


### 二、反序列化 JSON.parse()变成一个JavaScript对象

```
JSON.parse('{"name":"小明","age":14}'); 
// Object {name: '小明', age: 14}
```

`JSON.parse()` 还可以接收一个函数，用来转换解析出的属性

```
var obj = JSON.parse('{"name":"小明","age":14}', 
    function (key, value) {
        if (key === 'name') {
            return value + '同学';
    }
    return value;
});
console.log(JSON.stringify(obj)); // {name: '小明同学', age: 14}
```

```
PHP:
json_encode($arr)

JS:
json.stringfy()将对象、数组转换成字符串
json.parse()将字符串转成json对象
```